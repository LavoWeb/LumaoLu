<!doctype html><html lang=fr-lu><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Elastic Beanstalk déployer containeur Docker</title><meta name=description content><meta name=robots content=INDEX,FOLLOW><link rel="shortcut icon" href=https://lu.lumao.eu/favicon.ico type=image/x-icon><link rel=icon href=https://lu.lumao.eu/favicon.ico type=image/x-icon><link rel=canonical href=https://lu.lumao.eu/post/aws-docker-deploy/><link rel=alternate hreflang=fr-fr href=https://lumao.eu/post/aws-docker-deploy/><link rel=alternate hreflang=fr-ch href=https://lumao.ch/post/aws-docker-deploy/><link rel=alternate hreflang=fr-be href=https://be.lumao.eu/post/aws-docker-deploy/><link rel=alternate hreflang=fr-lu href=https://lu.lumao.eu/post/aws-docker-deploy/><meta name=generator content="Hugo 0.55.0-DEV"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-PXRXBBS');</script><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PXRXBBS" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><header class=header><div class=container><div class=row><div class=col-sm-2><a class="animsition-link site-logo" href=https://lu.lumao.eu/><p class=title>Lumao - Développement Magento</p></a></div><div class=col-sm-10><nav id=site-nav class=nav-toggle><ul class=menu><li><a href=https://lu.lumao.eu/><i class="fa fa-code" aria-hidden=true></i>Magento</a><li><a href=https://lu.lumao.eu/post/developpement-akeneo/><i class="fa fa-codepen" aria-hidden=true></i>Akeneo</a><li><a href=https://lu.lumao.eu/post/developpement-laravel/><i class="fa fa-connectdevelop" aria-hidden=true></i>Laravel</a><li><a href=https://lu.lumao.eu/post/contact/><i class="fa fa-comments" aria-hidden=true></i>Contact</a></ul></nav></div></div></div></header><div class="section section-content" id=section-content><div class=title-block><h1 class=title-big>Elastic Beanstalk déployer containeur Docker</h1></div><div class=container><div class=row><div class="col-md-12 about-info"><p>On a vu comment <a href=https://lumao.eu/post/gitlab-aws/>déployer automatiquement du code quand on push sur une branche</a>.
Maintenant, il est temps de customiser le déploiement pour mettre nos containeurs.<p><h2 class=post-title>Configuration Beanstalk (EB)</h2>Pas grand chose à faire, si vous avez ceci dans votre tableau de bord, c&rsquo;est bon :
<img src=/images/10/beanstalk.png alt="AWS EB Docker"><p><h2 class=post-title>Dockerfile</h2>Au déploiement, EB va lire les fichiers <strong>Dockerfile</strong> et <strong>Dockerrun.aws.json</strong>,
on va rester sur le premier vu qu&rsquo;on connait déjà.<p>Dans le principe, EB va éxecuter le containeur et le publier une fois qu&rsquo;il aura fini.<p>Il faut donc penser à ajouter les sources. Sinon rien de fou :<p><strong>Dockerfile</strong><pre><code>FROM lavoweb/php-7.0

COPY . /var/www/html/
RUN sed -ie s#/var/www/html#/var/www/html/public#g /etc/apache2/sites-enabled/000-default.conf

EXPOSE 80
</code></pre><p>On prend l&rsquo;image <strong>lavoweb/php-7.0</strong>, on copie notre code dans le répertoire <strong>/var/www/html/</strong>
On remplace le vhost pour qu&rsquo;il écoute sur le dossier <strong>public</strong>
Et c&rsquo;est tout.<p>A chaque push, on prendra la dernière version du containeur, ou mieux, celle qu&rsquo;on tag dans notre Dockerfile
avec la dernière version du code (de la branche en cours).</div></div></div></div><footer class=footer-bottom><p class=copyright>&copy; 2019 Lumao SASU - 835 305 657 R.C.S. Annecy - Développé avec <i class="fa fa-heart-o"></i>par LavoWeb -<p class=copyright>Nous nous déplaçons sur Luxembourg, Esch-alzette, Dudelange, Schifflange</footer><link rel=stylesheet href=https://lu.lumao.eu/dist/all.css><script src=https://lu.lumao.eu/dist/all.js></script><script>jQuery(document).ready(function(){jQuery('img').each(function(){jQuery(this).addClass('img-responsive');});jQuery('h2').each(function(){jQuery(this).addClass('title-middle');});});window.addEventListener('DOMContentLoaded',function(){var myLazyLoad=new LazyLoad({elements_selector:".lazy"});var myLazyLoadWebp=new LazyLoad({elements_selector:".lazy-webp",to_webp:true});},false);</script><script id=ze-snippet src="https://static.zdassets.com/ekr/snippet.js?key=5834f365-e0f5-4aed-929d-fd5bce2c17f7"></script>